<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fox & Hounds Hockey League</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #000000; }
        .card { background-color: #111111; border: 1px solid #333333; }
        .header-glow { border-bottom: 1px solid #333; }
        .rank-number { font-weight: 600; color: #DC143C; }
        .admin-btn { padding: 8px 16px; border-radius: 6px; font-weight: 600; transition: all 0.2s; background-color: transparent; border: 1px solid #FFD700; color: #FFD700; display: inline-block; }
        .admin-btn:hover { background-color: rgba(255, 215, 0, 0.1); }
        .team-logo-sm { width: 32px; height: 32px; border-radius: 50%; object-fit: cover; }
    </style>
</head>
<body class="text-gray-300">

    <header class="bg-black/70 backdrop-blur-sm sticky top-0 z-40 header-glow">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <a href="index.html" class="flex items-center space-x-3"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-yellow-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM5.5 9.5a.5.5 0 01.5-.5h2a.5.5 0 01.5.5v2a.5.5 0 01-.5.5h-2a.5.5 0 01-.5-.5v-2zM12 5.5a.5.5 0 00-.5.5v2a.5.5 0 00.5.5h2a.5.5 0 00.5-.5v-2a.5.5 0 00-.5-.5h-2zM6 12a.5.5 0 00-.5.5v2a.5.5 0 00.5.5h2a.5.5 0 00.5-.5v-2a.5.5 0 00-.5-.5H6zM11.5 12a.5.5 0 01.5-.5h2a.5.5 0 01.5.5v2a.5.5 0 01-.5.5h-2a.5.5 0 01-.5-.5v-2z" clip-rule="evenodd" /></svg><h1 class="text-xl font-bold text-white">Fox & Hounds</h1></a>
                <nav class="hidden md:flex items-center space-x-6">
                    <a href="index.html" class="font-semibold text-white">League Home</a>
                    <a href="player-stats.html" class="font-semibold text-gray-400 hover:text-white">Player Stats</a>
                </nav>
                <div class="flex items-center space-x-4">
                     <a href="admin.html" class="admin-btn">Admin Panel</a>
                </div>
            </div>
        </div>
    </header>

    <main class="flex-grow max-w-7xl w-full mx-auto px-4 sm:px-6 lg:px-8 py-10">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Standings Column -->
            <div>
                <h2 class="text-2xl font-semibold text-white text-center mb-4">League Rankings</h2>
                <div class="card rounded-lg p-4">
                    <ul id="standings-container" class="divide-y divide-gray-800">
                        <!-- Standings will be injected here -->
                    </ul>
                </div>
            </div>
            <!-- Matchups Column -->
            <div>
                <h2 class="text-2xl font-semibold text-white text-center mb-4">Weekly Matchups</h2>
                <div id="matchups-container" class="space-y-4">
                    <!-- Matchup cards will be injected here -->
                </div>
            </div>
        </div>
    </main>
    
<script>
    document.addEventListener("DOMContentLoaded", () => {
        async function fetchYahooData() {
            try {
                const response = await fetch('/api/get-yahoo-data', { credentials: 'include' });
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || `Failed to fetch Yahoo data. Status: ${response.status}`);
                }
                const data = await response.json();
                renderAll(data);
            } catch (error) {
                console.error("Error fetching Yahoo data:", error);
                const errorMessage = `Could not load live fantasy data. ${error.message.includes('Not authenticated') ? 'Connect account in Admin Panel.' : 'Please try again later.'}`;
                document.getElementById('matchups-container').innerHTML = `<p class="text-red-500 text-center">${errorMessage}</p>`;
                document.getElementById('standings-container').innerHTML = `<p class="text-red-500 text-center">${errorMessage}</p>`;
            }
        }
        
        function renderAll(data){
            renderMatchups(data.matchups || []);
            renderStandings(data.standings || []);
        }

        function renderMatchups(matchups){
            const container = document.getElementById("matchups-container");
            if(!container) return;
            container.innerHTML = '';
            if (matchups.length === 0) {
                container.innerHTML = `<div class="card p-4 text-center text-gray-500">No matchups available.</div>`;
                return;
            }

            matchups.forEach(matchup => {
                const team1 = matchup.team1;
                const team2 = matchup.team2;
                container.innerHTML += `
                    <div class="card p-4 rounded-lg">
                        <div class="flex justify-between items-center">
                            <div class="flex items-center text-left w-2/5 truncate">
                                <img src="${team1.logo}" class="team-logo-sm mr-3 flex-shrink-0" onerror="this.src='https://placehold.co/32x32/111/fff?text=?';">
                                <span class="font-semibold truncate">${team1.name}</span>
                            </div>
                            <div class="font-bold text-lg text-yellow-400 whitespace-nowrap">
                                <span>${team1.score}</span>
                                <span class="text-gray-500 mx-2">-</span>
                                <span>${team2.score}</span>
                            </div>
                            <div class="flex items-center text-right w-2/5 truncate justify-end">
                                <span class="font-semibold truncate">${team2.name}</span>
                                <img src="${team2.logo}" class="team-logo-sm ml-3 flex-shrink-0" onerror="this.src='https://placehold.co/32x32/111/fff?text=?';">
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        function renderStandings(standings){
            const container = document.getElementById("standings-container");
            if(!container) return;
            container.innerHTML = "";
            if (standings.length === 0) {
                container.innerHTML = `<p class="text-center text-gray-500 p-4">Standings could not be loaded.</p>`;
                return;
            }
            standings.forEach(team => {
                container.innerHTML += `
                    <li class="py-3 flex justify-between items-center">
                        <div class="flex items-center">
                            <span class="rank-number w-6 text-center">${team.rank}</span>
                            <img class="team-logo-sm w-8 h-8 ml-3" src="${team.logo}" alt="${team.name} logo">
                            <p class="ml-3 font-medium text-white">${team.name}</p>
                        </div>
                        <p class="text-gray-400 font-mono text-sm">${team.wins}-${team.losses}-${team.ties}</p>
                    </li>`;
            });
        }
    
        fetchYahooData();
    });
</script>
</body>
</html>

